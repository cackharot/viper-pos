{% extends "templates/layout.jinja2" %}
{% block content %}
<section id="home-page">
	 <div class="page-header">
      <h1>Welcome {{ user.UserName}},</h1>
     </div> 
      <div class="row-fluid">
        <div class="span6">
        	<h3>Return Products
        	<span style="margin-left:20px;font-size:14px;">Total: <span id="totalReturns">0</span></span>
        	</h3>
        	<table class="table" id="tblReturns">
        		<thead>
        			<th>Barcode</th>
        			<th>Name</th>
        			<th>MRP</th>
        			<th>Stock</th>
        		</thead>
        		<tbody>
        		</tbody>
        	</table>
        </div>
        <div class="span6">
        	<h3>Low Stock Products</h3>
        	
        </div>
        <div class="span6">
        	<h3>Top Customers</h3>
        	
        </div>
        <div class="span6">
        	<h3>Credit Purchases</h3>
        	
        </div>
        <div class="span6">
        	<h3>Credit Orders</h3>
        	
        </div>
      </div>
</section>
<section style="display:none;" id="templates">
	<script type="text/template"  id="tdReturnProduct">
		<% _.each(items,function(item) { %>
		<tr>
			<td><%= item.Barcode%></td>
			<td><%= item.Name%></td>
			<td><%= item.MRP%></td>
			<td><%= item.Stock%></td>
		</tr>
		<% }); %>
	</script>
</section>
{% endblock content %}
{% block footerscript %}
<script>
	$(function() {
		$.post('reports/getreturnproducts',null,function(data){
			if(data && data.status == true) {
				var compiled = _.template($('#tdReturnProduct').html())
				var rows = compiled({
					'items': data.items
				})
				$('#totalReturns').text(data.total || data.items.length)
				$('table#tblReturns tbody').append(rows).fadeIn()
			}
		})
	})
</script>
{% endblock footerscript %}
