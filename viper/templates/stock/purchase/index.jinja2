{% extends "templates/layout.jinja2" %}
{% block content %}
<section id="manage-purchase">
	<div class="page-header">
		<h1>Purchase Management
			 <small class="pull-right">
			  	<a href="{{'addpurchase'|route_url}}" title="Add New Purchase!" class="btn btn-primary">
			  		<i class="icon-plus icon-white"></i> Add 
			  	</a>
			 </small>
		 </h1>
	</div> 	
	<div class="row-fluid">
		<div class="span12">
			<form id="searchForm" class="well form-inline" action="{{'purchases_xhr'|route_url}}">
				<label for="billNo">Bill No# </label>
				<input type="text" name="billNo" placeholder="Enter bill no" autofocus/>
				<label for="billDate">Bill Date: </label>
				<input type="text" name="billDate" class="datetime" placeholder="Enter bill date"/>
				<label for="supplierId">Supplier: </label>
				<select name="supplierId">
					<option value="">--Select--</option>
					{% for item in suppliers if suppliers -%}
						<option value="{{item[0]}}">{{item[1]}}</option>
					{%- endfor %}
				</select>
				<input type="hidden" name="pageSize" value="20"/>
				<input type="submit" name="submit" value="Search" class="btn btn-success"/>
				<input type="reset" name="reset" value="Reset" class="btn"/>
			</form>
		</div>
	</div>
	<div id="statusMessage"></div>
    <div id="result">
    	{% include 'templates/stock/purchase/partialPurchaseList.jinja2' with context %}
	</div>
</section>      
{% endblock %}
{% block footerscript %}
<script>
	$(function(){
		$('input.datetime').datepicker({ dateFormat: 'dd-mm-yy' })
		
		$('form#searchForm').submit(function(){
			var postdata = $(this).serialize()
			$.post($(this).attr('action'),postdata,function(data){
				if(data){
					$('#result').html(data)
				}else{
					// search returns no value
					$('#result').html('<div class="alert alert-info">No items found!</div>')
				}
			})
			return false
		})
	});
</script>
{% endblock %}
